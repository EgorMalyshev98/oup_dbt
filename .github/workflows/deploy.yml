name: deploy

on:
  push:
    branches: ["master"]

jobs:
   build:
     runs-on: ubuntu-latest
     # env:
     #   DBT_USER: ${{secrets.DBT_USER}}
     #   DBT_PASS: ${{secrets.DBT_PASS}}
     #   DB_NAME: ${{secrets.DB_NAME}}
     #   DB_PORT: ${{secrets.DB_PORT}}
     steps:
      - name: Checkout_Repository
        uses: actions/checkout@v3
  
      - name: Set up SSH
        run: |
          mkdir -p ~/.ssh
          echo "${{ secrets.OUP_SSH_PRIVATE_KEY }}" > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan -t rsa ${{secrets.OUP_IP}} >> ~/.ssh/known_hosts
          ssh -i ~/.ssh/id_rsa -p ${{secrets.OUP_SSH_PORT}} -N -L ${{secrets.DB_PORT}}:${{secrets.OUP_LOCAL_IP}}:${{secrets.DB_PORT}} odmin@${{secrets.OUP_IP}}
       
       
    
